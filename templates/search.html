<!DOCTYPE html>
<html>
<head>
    <title>Blog Search</title>
    <link data-n-head="ssr" rel="stylesheet" href="https://lf3-cdn-tos.bytescm.com/obj/static/xitu_juejin_web/static/bytedesign.min.css">
    <link rel="stylesheet" href="//lf3-cdn-tos.bytescm.com/obj/static/xitu_juejin_web/93.471382d.css">
    <link rel="preload" href="//lf3-cdn-tos.bytescm.com/obj/static/xitu_juejin_web/app.f81e9f9.css" as="style">
    <link rel="stylesheet" href="//lf3-cdn-tos.bytescm.com/obj/static/xitu_juejin_web/layouts/default.846c2b6.css">
    <style>
      em {
          color: red;
          font-weight: bold;
      }
      .hidden {
          display: none;
      }
      .container {
        max-width: 800px; /* Adjust this value to match the width of the blog list */
        margin: 0 auto; /* Center the container */
      }
      .search-box {
        display: flex;
        border: 1px solid #ccc;
        border-radius: 20px;
        overflow: hidden;
        max-width: 800px; /* Set a max-width for the search box */
        margin: 0 auto; /* Center the search box */
        width: 100%; /* Take full width */
      }

      .search-box input[type="text"] {
        border: none;
        padding: 10px;
        flex: 1; /* Allow the input to grow and fill the space */
        border-radius: 20px 0 0 20px;
        outline: none;
      }

      .search-box button {
        background-color: #f8f9fa; /* Light background for the button */
        border-left: 1px solid #ccc; /* Add a border to separate it from the input */
        padding: 10px;
        cursor: pointer;
      }

      .search-box button .search-icon {
        fill: #555; /* Change the color of the icon */
        display: block; /* Ensure the SVG icon is centered */
        margin: auto; /* Center the icon horizontally */
      }
  </style>

</head>
<body>
  <div class="view-container" data-v-5762947c="" data-v-5e485b9d="">
    <div class="main-header-box" data-v-5762947c="">
      <div class="container" data-v-925171a8="">

        <nav role="navigation" class="main-nav" data-v-925171a8="">
          <ul class="right-side-nav" data-v-925171a8="">   
                <li class="nav-item search" data-v-925171a8="">
                  <form role="search" action="/search"  class="search-form" data-v-925171a8="" method="post">
                    <div class="search-box">
                      <input type="text" name="keyword" placeholder="请输入要搜索的博客...">
                      <button type="submit">
                        <svg class="search-icon" width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path d="M12.4008 12.4008C14.744 10.0577 14.744 6.25871 12.4008 3.91556C10.0577 1.57242 6.25871 1.57242 3.91556 3.91556C1.57242 6.25871 1.57242 10.0577 3.91556 12.4008C6.25871 14.744 10.0577 14.744 12.4008 12.4008ZM12.4008 12.4008L15.5828 15.5828" stroke="#555" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
                        </svg>
                      </button>
                    </div>
                  </form>
            </li>
          </ul>
        </nav>
      </div>
      
    </div> 
  
    <main class="container main-container" data-v-5762947c="">
      <div class="view search-view" data-v-5762947c="" data-v-5b0fca76="">
      
        <div class="search-list result-list" data-v-69f75cae="" data-v-5b0fca76="" data-v-5762947c="">
          <header class="list-header" data-v-69f75cae="">
            <nav role="navigation" class="list-nav" data-v-69f75cae="">
              <ul class="nav-list left" data-v-69f75cae="">
                <li class="nav-item active" data-v-69f75cae=""><a href="{{ url_for('search', keyword=search_query, source=source, sort_by='custom') }}">综合排序</a></li>
                <li class="nav-item" data-v-69f75cae=""><a href="{{ url_for('search', keyword=search_query, source=source, sort_by='latest') }}">最新优先</a></li>
                <li class="nav-item" data-v-69f75cae=""><a href="{{ url_for('search', keyword=search_query, source=source, sort_by='hottest') }}">最热优先</a></li>
              </ul> 
              <div class="dorp-down-area" data-v-69f75cae="">
                <div class="drop-down" data-v-77151aa1="" data-v-69f75cae=""><li class="dropdown-toggle" data-v-77151aa1="">时间不限<i class="icon" data-v-77151aa1=""></i></li> 
                  <ul data-v-77151aa1="" class="dropdown-menu hidden">
                    <li><a href="{{ url_for('search', keyword=search_query, source=source, sort_by='latest', period=0) }}" data-label="时间不限">时间不限</a></li>
                    <li><a href="{{ url_for('search', keyword=search_query, source=source, sort_by='latest', period=1) }}" data-label="最近一天">最近一天</a></li>
                    <li><a href="{{ url_for('search', keyword=search_query, source=source, sort_by='latest', period=2) }}" data-label="最近一周">最近一周</a></li>
                    <li><a href="{{ url_for('search', keyword=search_query, source=source, sort_by='latest', period=3) }}" data-label="最近三月">最近三月</a></li>
                  </ul>
                </div>
              </div>
           
        
            </nav>
          </header> 
          <div data-v-090682e2="" data-v-69f75cae="">
            <div class="result-list" data-v-090682e2="">
              <ul data-v-43394619="" data-v-69f75cae="" class="main-list" data-v-090682e2="">
              
                {% for article in blogs %}
                <li data-v-43394619="" class="item">
                  <div data-v-0347d762="" data-v-43394619="" class="entry">
                    <a data-v-65b50b51="" data-v-0347d762="" href="{{ article.url}}" target="_blank" rel="" class="jj-link entry-link">
                      <object data-v-0347d762="" data-v-65b50b51="">
                        <div data-v-0347d762="" data-v-65b50b51="" class="content-box">
                          <div data-v-0347d762="" data-v-65b50b51="" class="info-box">
                            <div data-v-0347d762="" data-v-65b50b51="" class="info-row meta-row">
                              <ul data-v-0347d762="" data-v-65b50b51="" class="meta-list">
                                <li data-v-0347d762="" data-v-65b50b51="" class="item username clickable">
                                  <a data-v-65b50b51="" data-v-0347d762="" href="{{ article.user_id }}" target="_blank" rel="" class="jj-link user-message"><div data-v-487cbd49="" data-v-d7aef884="" data-v-0347d762="" class="popover-box user-popover" data-v-65b50b51=""><!---->  {{ article.user_name }}</div></a></li> 
                                <li data-v-0347d762="" data-v-65b50b51="" class="item">{{ article.last_modify }}天前</li> 
                                <li data-v-0347d762="" data-v-65b50b51="" class="item tag">
                                  {% for tag in article.tags %}
                                      <a data-v-65b50b51="" data-v-0347d762="" href="{{ article.base_url }}/tag/{{tag.tag_name}}" target="_blank" rel="" class="jj-link tag">{{tag.tag_name}}</a>
                                  {% endfor %}
                                </li>
                              </ul>
                            </div> 
                            <div data-v-0347d762="" data-v-65b50b51="" class="info-row title-row">
                              <a data-v-65b50b51="" data-v-0347d762="" href="{{ article.url}}" target="_blank" rel="" class="jj-link title">
                                    <div data-v-0347d762="" data-v-65b50b51="">{{ article.title|safe }}</div>
                                </a>
                            </div> 
                            <div data-v-0347d762="" data-v-65b50b51="" class="info-row abstract-row"><a data-v-65b50b51="" data-v-0347d762="" href="{{ article.url}}" target="_blank" rel="" class="jj-link abstract"><div data-v-0347d762="" data-v-65b50b51="">{{ article.brief|safe}}</div></a></div> 
                            <div data-v-0347d762="" data-v-65b50b51="" class="info-row action-row">
                              <ul data-v-0347d762="" data-v-65b50b51="" class="action-list">
                                <li data-v-0347d762="" data-v-65b50b51="" class="item like clickable"><a data-v-0347d762="" data-v-65b50b51="" class="title-box"><img data-v-0347d762="" data-v-65b50b51="" src="//lf3-cdn-tos.bytescm.com/obj/static/xitu_juejin_web/e9d76988a7ae3392dc967cfbb64cd887.svg" class="icon"> <span data-v-0347d762="" data-v-65b50b51="" class="count">{{ article.digg_count}}</span></a></li>
                                <li data-v-0347d762="" data-v-65b50b51="" class="item like clickable"><button>{{ article.base_name }}</button></li>
                                <li data-v-0347d762="" data-v-65b50b51="" class="item like clickable">
                                  <button class="crawl-article-btn" data-article-url="{{ article.url}}" style="background-color: orange;">一键抓取</button>
                                </li> 
                              
                              </ul>
                            </div>
                          </div>

                          {% if article.imgUrl  %}
                              <img data-v-5244ef91="" data-v-0347d762="" src="{{ article.imgUrl  }}" alt="image" class="lazy thumb" data-v-65b50b51="" loading="lazy" style="">
                          {% endif %}
                        
                        </div>
                      </object>
                    </a>
                  </div>
                </li>
                {% endfor %}
              </ul>
            </div>
          </div>
        </div>
      </div>
    </main>
    </div>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
          const dropdownToggle = document.querySelector('.dropdown-toggle');
          const dropdownMenu = document.querySelector('.dropdown-menu');
          const currentUrl = new URL(window.location.href);
          const period = currentUrl.searchParams.get('period'); // 获取URL中的period参数

          // 根据period参数更新下拉菜单显示的文本
          const periodTexts = {
              '0': '时间不限',
              '1': '最近一天',
              '2': '最近一周',
              '3': '最近三月'
          };
          if (periodTexts[period]) {
              dropdownToggle.innerHTML = periodTexts[period] + '<i class="icon" data-v-77151aa1=""></i>';
          }
          
          dropdownToggle.addEventListener('click', function(e) {
              e.preventDefault();
              dropdownMenu.classList.toggle('hidden'); // 切换下拉菜单的可见性
          });

          // 为每个下拉菜单项添加点击事件监听器
          document.querySelectorAll('.dropdown-menu a').forEach(item => {
              item.addEventListener('click', function(e) {
                  // 阻止链接的默认行为
                  e.preventDefault();
                  // 更新.dropdown-toggle的文本为选中项的文本
                  const selectedText = this.getAttribute('data-label');
                  dropdownToggle.innerHTML = selectedText + '<i class="icon" data-v-77151aa1=""></i>';
                  // 关闭下拉菜单
                  dropdownMenu.classList.add('hidden');
                  // 触发页面跳转到选中项对应的URL
                  window.location.href = this.href;
              });
          });

          document.querySelectorAll('.crawl-article-btn').forEach(button => {
              button.addEventListener('click', function(e) {
                  e.preventDefault();
                  const articleUrl = this.getAttribute('data-article-url'); // 获取按钮上的data-article-url属性
                  console.log("Article URL: " + articleUrl);
                  fetch(`/crawl-article?url=${encodeURIComponent(articleUrl)}`)
                      .then(response => response.json())
                      .then(data => {
                          console.log('Crawl success:', data);
                          // 处理成功响应
                      })
                      .catch((error) => {
                          console.error('Crawl error:', error);
                          // 处理错误
                      });
              });
          });
      });
      </script>
</body>
</html>
